<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
	<head>
		<title>The PdmV Validation DB</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link href="/libs/bootstrap/2.1.0/css/bootstrap.min.css" rel="stylesheet">
        <link href="/libs/bootstrap/2.1.0/css/bootstrap-responsive.css" rel="stylesheet">
		<link href="media/menu.css" rel="stylesheet">
	<script type="text/javascript" src="/libs/jquery-1.7.2.min.js" ></script>
	<script type="text/javascript" src="/libs/bootstrap/2.1.0/js/bootstrap.min.js" ></script>



<!--Modals for pop-up information-->
<!--Default modal for showing information-->
          <div id="myModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <h2>Release: <text id="modalReleaseName"></text></h2>
	      <h4><text id="modalHeaderTree"></text><h4>
	      <h3>Author: <text id = "author"></text></h3>

	    </div>
	    <div id ="modalkunas" class="modal-body">
	      <h4>Validation Status: <text id ="valStat"></text> </h4>
	      <p>Comments:</br> <text id ="comments" style="width: 454px; height:129px;"></text> </p>
            <text id="linkTEXT">Links:</text> 
            <p id="links"></p>

	    </div>
	    <div class="modal-footer">
	      <p> Date: <text id = "comdate"></text></p>
	       <a onclick="editModalInfo();" data-dismiss="modal" class="btn" id="btnEditInfo"> Edit Information </a>
           <a href="#" class="btn btn-primary" data-dismiss="modal" >Close</a>
	    </div>
	  </div>

<!-- MODAL for admin to add new Release into dataBase-->
          <div id="newReleaseModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <form>
		<label class="span2">Category:</label>
		<select id="newCatName" onchange= "addStats('#newCatName')"> 
		  <option value="------">------</option>

          <option value="Reconstruction">Reconstruction</option>
		  <option value="HLT">HLT</option>
		  <option value="PAGs">PAGs</option>
		  <option value="All">All</option>
		</select><br/>
		<label class="span2">SubCategory:</label> 
		<select id="editSubCategories">
		  <option value="Data"> Data </option>
		  <option value="FullSim">FullSim </option>
		  <option value="FastSim">FastSim </option>
		  <option value="All">All</option>
		</select><br/>
		<label class="span2">Release Name:</label> 
		<input type="text" id="newRelName"/> <br/>
		<label class="span2">RelMon URL:</label> 
        <input type="text" id="RelMon_URL"/> <br/>
		<div id="newStats">
		</div>

	      </form>
	    </div>
	    <div class="modal-footer">
	      <a onclick="addNewRelease(this);" class="btn btn-success" id="newModalSaveBTN"> Save Information </a>
	      <a onclick="closedNewReleaseModal(this);" class="btn btn-primary" data-dismiss="modal" >Close</a>
	    </div>
	  </div>

<!--MODAL to edit available release stats information-->
        <div id="editModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <h2>Release: <text type="text" id="modalEditReleaseName"/><br/></h2>
	      <h4> <text id="editModalHeaderTree"> </text><h4>
	      <h3>Author: <text type="text" id="modalEditAuthor"/><br/></h3>
	    </div>

	    <div id ="modalkunas" class="modal-body">
		<h4> <text id="valStatName"></text>
		     Validation Status:<h4>
		    <select id="editDropdown">
			<option value='NOT YET DONE'>NOT YET DONE</option>
			<option value='OK'>OK</option>
			<option value='FAILURE'>FAILURE</option>

			<option value='CHANGES EXPECTED'>CHANGES EXPECTED</option>
			<option value='IN PROGRESS'>IN PROGRESS</option>
			<option value='OK TO BE SIGNED-OFF BY THE VALIDATORS'>OK TO BE SIGNED-OFF BY THE VALIDATORS</option>
			<option value='FAILURE TO BE SIGNED-OFF BY THE VALIDATORS'>FAILURE TO BE SIGNED-OFF BY THE VALIDATORS</option>
		    </select>
		<p>Comments:</br><textarea id ="modalEditComments" rows="3" name="comment" cols="24" style="width: 454px; height:129px;"></textarea> <br/></p>

		<p>Links: </br><textarea id="modalEditLinks" style="width: 362px; height:60px;"></textarea> </p>
	    </div>
	    <div class="modal-footer" id="editModalFooter">
            <div>
                <text align='left' style='font-size:14px;'>
                    The message will be sent to: <text id='hn-address'></text>
                </text>
            </div>
            <div>
                <input id="btnSave" class="btn" type="submit" value="Save information" onclick="notEmpty();" />
                <a onclick="clearEditModalValues();" class="btn btn-primary" data-dismiss="modal" >Close</a>
            </div>
	    </div>
	  </div>

<!-- MODAL TO get history selection -->
          <div id="historyModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <form>
		Reconstruction:
			      <ul id="recoStatList"style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="TK">Tracker</li>
				<li ><input type="checkbox" id="ECAL">Ecal</li>
				<li ><input type="checkbox" id="HCAL" >Hcal</li>
				<li ><input type="checkbox" id="DT" >DT</li>
				<li ><input type="checkbox" id="CSC">CSC</li>
				<li ><input type="checkbox" id="RPC" >RPC</li>

				<li ><input type="checkbox" id="TRACKING">Tracking</li>
				<li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON">Muon</li>
				<li ><input type="checkbox" id="JET">Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
				<li ><input type="checkbox" id="BTag">bTag</li>
				<li ><input type="checkbox" id="TAU">Tau</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>

			      </ul>
		HLT:
			      <ul id="hltStatList"style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
			        <li ><input type="checkbox" id="TRACKING">Tracking</li>
				    <li ><input type="checkbox" id="ELECTRON">Electron</li>
				    <li ><input type="checkbox" id="PHOTON">Photon</li>
				    <li ><input type="checkbox" id="MUON" >Muon</li>
				    <li ><input type="checkbox" id="JET" >Jet</li>
				    <li ><input type="checkbox" id="MET">MET</li>
				    <li ><input type="checkbox" id="BTAG" >bTag</li>
				    <li ><input type="checkbox" id="TAU" >Tau</li>
				    
				    <li ><input type="checkbox" id="SMP" >SMP</li>
				    <li ><input type="checkbox" id="HIGGS">Higgs</li>
				    <li ><input type="checkbox" id="TOP">Top</li>
				    <li ><input type="checkbox" id="SUSY">Susy</li>
				    <li ><input type="checkbox" id="EXOTICA">Exotica</li>
				    <li ><input type="checkbox" id="B">B</li>
				    <li ><input type="checkbox" id="FWD">Fwd</li>
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			      </ul>
		PAGs:
			  <ul id="pagsStatList"style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP" >Top</li>
				<li ><input type="checkbox" id="SUSY" >Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B" >B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>

			  </ul>
		SubCategories:			      
			      <ul id="subCatList"style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="Data">Data</li>
				<li ><input type="checkbox" id="FullSim">FullSim</li>
				<li ><input type="checkbox" id="FastSim" >FastSim</li>
			      </ul>
		Releases: 
			      <ul id="historyList"style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">

			      </ul>
	      </form>
	    </div>
	    <div class="modal-footer">
	      <a onclick="clearHistoryModal();" class="btn btn-primary" data-dismiss="modal" >Close</a>
	      <a onclick="getHistoryBtn(this);" class="btn btn-success" data-dismiss="modal">Get History</a>
	    </div>

	  </div>
<!--MODAL to REMOVE user-->
          <div id="rmUserModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <h4>Remove user</h4>
	    </div>
	    <div class="modal-body">
	      <h3>User name to be removed: <input type="text" id="userNameToBeRemoved"/><br/></h3>

	    </div>
	    <div class="modal-footer" id="rmUserModalFooter">
	      <a class="btn btn-primary" data-dismiss="modal" >Close</a>
	      <a onclick="rmUser(this);" class="btn btn-danger" data-dismiss="modal">Remove User</a>
	    </div>
	  </div>

<!-- Modal to Add new User -->

          <div id="addUserModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <h2>Add new user</h2>
	    </div>
	    <div class="modal-body">
	    <form>
	      User name: <input type="text" id="newUsrName"/> <br>
          E-mail: <input type="text" id="newUserEmail"/> <br>
		<h4> User type:</h4>
		    <select id="userTypeList" onchange='showUserForm(this)'>
			<option value='------'>------</option>
			<option value='Validator'>Validator</option>
			<option value='Admin'>Admin</option>
		    </select> 
	      <br>

	    </form>
	      <form class="showM" id="usrFormList">
		<b>Reconstruction/Data:</b>
			  <ul id="usrRDataStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="TK">Tracker</li>
				<li ><input type="checkbox" id="ECAL">Ecal</li>
				<li ><input type="checkbox" id="HCAL" >Hcal</li>
				<li ><input type="checkbox" id="DT" >DT</li>
				<li ><input type="checkbox" id="CSC">CSC</li>
				<li ><input type="checkbox" id="RPC" >RPC</li>
				
				<li ><input type="checkbox" id="TRACKING">Tracking</li>
				<li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON">Muon</li>
				<li ><input type="checkbox" id="JET">Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
				<li ><input type="checkbox" id="BTAG">bTag</li>
				<li ><input type="checkbox" id="TAU">Tau</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>
		 <b>Reconstruction/FastSim:</b>
			  <ul id="usrRFastStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="TK">Tracker</li>
				<li ><input type="checkbox" id="ECAL">Ecal</li>
				<li ><input type="checkbox" id="HCAL" >Hcal</li>
				<li ><input type="checkbox" id="DT" >DT</li>
				<li ><input type="checkbox" id="CSC">CSC</li>
				<li ><input type="checkbox" id="RPC" >RPC</li>
				
				<li ><input type="checkbox" id="TRACKING">Tracking</li>
				<li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON">Muon</li>
				<li ><input type="checkbox" id="JET">Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
				<li ><input type="checkbox" id="BTAG">bTag</li>
				<li ><input type="checkbox" id="TAU">Tau</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>
		 <b>Reconstruction/FullSim:</b>
			  <ul id="usrRFullStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="TK">Tracker</li>
				<li ><input type="checkbox" id="ECAL">Ecal</li>
				<li ><input type="checkbox" id="HCAL" >Hcal</li>
				<li ><input type="checkbox" id="DT" >DT</li>
				<li ><input type="checkbox" id="CSC">CSC</li>
				<li ><input type="checkbox" id="RPC" >RPC</li>
				
				<li ><input type="checkbox" id="TRACKING">Tracking</li>
				<li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON">Muon</li>
				<li ><input type="checkbox" id="JET">Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
				<li ><input type="checkbox" id="BTAG">bTag</li>
				<li ><input type="checkbox" id="TAU">Tau</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>

		<b>HLT/Data:</b>
			  <ul id="usrHDataStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="TRACKING">Tracking</li>
				<li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON" >Muon</li>
				<li ><input type="checkbox" id="JET" >Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
				<li ><input type="checkbox" id="BTAG">bTag</li>
				<li ><input type="checkbox" id="TAU" >Tau</li>
				
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP">Top</li>
				<li ><input type="checkbox" id="SUSY">Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B">B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>

				<li ><input type="checkbox" id="SUMMARY">Info</li>
			 </ul>
		<b>HLT/FastSim:</b>
			  <ul id="usrHFastStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
			    <li ><input type="checkbox" id="TRACKING">Tracking</li>
			    <li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON" >Muon</li>
				<li ><input type="checkbox" id="JET" >Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
                <li ><input type="checkbox" id="BTAG">bTag</li>
				<li ><input type="checkbox" id="TAU" >Tau</li>
				
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP">Top</li>
				<li ><input type="checkbox" id="SUSY">Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B">B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>

				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>
	    <b>HLT/FullSim:</b>
			  <ul id="usrHFullStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="TRACKING">Tracking</li>
				<li ><input type="checkbox" id="ELECTRON">Electron</li>
				<li ><input type="checkbox" id="PHOTON">Photon</li>
				<li ><input type="checkbox" id="MUON" >Muon</li>
				<li ><input type="checkbox" id="JET" >Jet</li>
				<li ><input type="checkbox" id="MET">MET</li>
                <li ><input type="checkbox" id="BTAG">bTag</li>
				<li ><input type="checkbox" id="TAU" >Tau</li>
				
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP">Top</li>
				<li ><input type="checkbox" id="SUSY">Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B">B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>
		<b>PAGs/Data:</b>
			  <ul id="usrPDataStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP" >Top</li>
				<li ><input type="checkbox" id="SUSY" >Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B" >B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>			      
		<b>PAGs/FastSim:</b>
			  <ul id="usrPFastStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP" >Top</li>
				<li ><input type="checkbox" id="SUSY" >Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B" >B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>
				
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>
		<b>PAGs/FullSim:</b>
			  <ul id="usrPFullStatList" style=" height: 100px; overflow: auto; width: 200px; border: 1px solid #000;">
				<li ><input type="checkbox" id="SMP">SMP</li>
				<li ><input type="checkbox" id="HIGGS">Higgs</li>
				<li ><input type="checkbox" id="TOP" >Top</li>
				<li ><input type="checkbox" id="SUSY" >Susy</li>
				<li ><input type="checkbox" id="EXOTICA">Exotica</li>
				<li ><input type="checkbox" id="B" >B</li>
				<li ><input type="checkbox" id="FWD">Fwd</li>
				<li ><input type="checkbox" id="SUMMARY">Info</li>
			  </ul>
          </form>
	    </div>
	    <div class="modal-footer">
	      <a onclick="addUserButtonModal();" class="btn btn-success" data-dismiss="modal"> Add User </a>
	      <a class="btn btn-primary" data-dismiss="modal" >Close</a>
	    </div>
	  </div>
<!--Modal to search for Validators information-->
      <div id="srchUserModal" class="modal hide fade" style="max-height:500px;">
	    <div class="modal-header">
	      <h4>Search for Validator(-s) editing information</h4>
	    </div>
	    <div class="modal-body">
	      <h3>Username: <input type="text" id="userNameToSearch"/><br/></h3>

	    </div>
	    <div class="modal-footer" id="rmUserModalFooter">
	      <a class="btn btn-primary" data-dismiss="modal" >Close</a>
	      <a onclick="srchUser();" class="btn btn-success" data-dismiss="modal"> Search </a>
	    </div>
	  </div>
<!--Modals for pop-up information-->

<!--MODAL to show loading while adding new release-->
  <div class="modal hide" id="loadModal" style="max-height:500px;">
    <div class="modal-body">
        <img src="media/loading_sentence.gif" alt="loading"/>  
    </div>
    </div>

</head>
	<body>
	
		<body style="background-color: #ADD8E6">
		<br>
                 <div class="container">
		  <div class="row">
		    <div class="span11">
		      <h1  id="title" style="text-align:center; font-family:verdana">ValDb: The PdmV Validation DB</h1>
		    </div>

		    <div class="span1">
		      <span id='userNameButton'>%USERNAME</span>
		      <input name = "logOutBTN" class="btn" type="button" value="Logout" onclick="logoutUser();"/>
		    </div>
		  </div>
		</div>
		<br>
		<br>	
	
	
<div class="container">
		<div class="row">

			<div class="span9">
				<div>
					<label style="font-family:verdana; font-size:18px"><br></label>
					<form id="searchform" action="#" method="post" class="form-inline">
							<label for="releaseName" style="display:inline; font-family:verdana; font-size:18px">Select one release  </label>
							<input type="text" id="releaseName" />
							<input class="btn" type="submit" value="OK" onclick="clearSelectList();"/>
							<output id="buttonOk">

					</form>
				</div>
					<hr align="left" width="100%" size="4" style="background-color:black">
				<div>
					<label style="font-family:verdana; font-size:18px; display:inline">Validation Tables</label>
					<input name = "addReleaseBTN" class="btn" type="button" value="Add Release" onclick="addRelease();"/>
					<br>
					
				</div>

				<div>
				  <h3 id="legend" style="text-align:left; font-family:verdana">Legend</h3>
				    <ul>
				      <li> 
					  <img width="16" alt="target" align="top" src="media/target.gif" height="16" border="0" /> : Changes are expected;
				      </li> 
				      <li> 
					  <img width="16" alt="choice-no" align="top" src="media/choice-no.gif" height="16" border="0" /> : Failure;
				      </li> 
				      <li> 
					  <img width="16" alt="choice-yes" align="top" src="media/choice-yes.gif" height="16" border="0" /> : OK;
				      </li> 
				      <li> 
					  <img width="16" alt="wip" align="top" src="media/wip.gif" height="16" border="0" /> : In progress;
				      </li> 
				      <li> 
					  <img width="16" alt="minus" align="top" src="media/minus.gif" height="16" border="0" /> : Not yet done;
				      </li> 
				      <li> 
					  <img width="16" alt="stop" align="top" src="media/thumbs-up.gif" height="16" border="0" /> : OK - to be signed-off by the validators;
				      </li>

 
				      <li> 
					  <img width="16" alt="stop" align="top" src="media/thumbs-down.gif" height="16" border="0" /> : Failure - to be signed-off by the validators;
				      </li>
				    </ul>
				</div>
				<div>
				<input class="btnOK" type="submit" value="Show All" onclick="showAllMenus();"/>
				
				<div>
                        <table border='0'>
                            <tbody>
                                <td style='margin:0; padding:0;'>
                                    <a href="javascript:showMenu('RECO')" class="Group">Reconstruction </a>
                                </td>
                                <td style='margin:0; padding:0;'>
                                    <input class="btnOK" type="submit" value="Show All" onclick="showRecoMenu();" style='width=100%;height=100%; margin:0; padding:0;'/>
                                </td>
                            </tbody>
                        </table>
						<div class="showM" id="RECO">
							<a class="SubCategory" href="javascript:showMenu('iRData');"> Data</a>
							<div class="showM" id="iRData">
								<table name = "infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id= "RData" border="0">
									<tbody>
									<th style="font-size: 8pt">Release Name</th>

									<th style="font-size: 8pt">Tracker</th>
									<th style="font-size: 8pt">Ecal</th>
									<th style="font-size: 8pt">Hcal</th>
									<th style="font-size: 8pt">DT</th>
									<th style="font-size: 8pt">CSC</th>
									<th style="font-size: 8pt">RPC</th>
									
									<th style="font-size: 8pt">Tracking</th>
									<th style="font-size: 8pt">Electron</th>
									<th style="font-size: 8pt">Photon</th>
									<th style="font-size: 8pt">Muon</th>
									<th style="font-size: 8pt">Jet</th>
									<th style="font-size: 8pt">MET</th>
									<th style="font-size: 8pt">bTag</th>
									<th style="font-size: 8pt">Tau</th>

									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
									</tbody>
								</table>
							</div>
							<a href="javascript:showMenu('iRFull')" class="SubCategory"> FullSim</a>
							<div class="showM" id="iRFull">
								<table name= "infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='RFull' border="0">
                                    <tbody>
									<th style="font-size: 8pt">Release Name</th>

									<th style="font-size: 8pt">Tracker</th>
									<th style="font-size: 8pt">Ecal</th>
									<th style="font-size: 8pt">Hcal</th>
									<th style="font-size: 8pt">DT</th>
									<th style="font-size: 8pt">CSC</th>
									<th style="font-size: 8pt">RPC</th>

									<th style="font-size: 8pt">Tracking</th>
									<th style="font-size: 8pt">Electron</th>
									<th style="font-size: 8pt">Photon</th>
									<th style="font-size: 8pt">Muon</th>
									<th style="font-size: 8pt">Jet</th>
									<th style="font-size: 8pt">MET</th>
									<th style="font-size: 8pt">bTag</th>
									<th style="font-size: 8pt">Tau</th>

									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
									</tbody>
								</table>

							</div>
							<a href="javascript:showMenu('iRFast')" class="SubCategory"> FastSim</a>
							<div class="showM" id="iRFast">
								<table name = "infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='RFast' border="0">
									<tbody>
									<th style="font-size: 8pt">Release Name</th>

									<th style="font-size: 8pt">Tracker</th>
									<th style="font-size: 8pt">Ecal</th>
									<th style="font-size: 8pt">Hcal</th>
									<th style="font-size: 8pt">DT</th>
									<th style="font-size: 8pt">CSC</th>
									<th style="font-size: 8pt">RPC</th>

									<th style="font-size: 8pt">Tracking</th>
									<th style="font-size: 8pt">Electron</th>
									<th style="font-size: 8pt">Photon</th>
									<th style="font-size: 8pt">Muon</th>
									<th style="font-size: 8pt">Jet</th>
									<th style="font-size: 8pt">MET</th>
									<th style="font-size: 8pt">bTag</th>
									<th style="font-size: 8pt">Tau</th>

									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
									</tbody>
								</table>
							</div>
						</div>
                        <table border='0'>
                            <tbody>
                                <td style='margin:0; padding:0;'>
                                    <a href="javascript:showMenu('HLT')" class="Group">HLT</a>
                                </td>
                                <td style='margin:0; padding:0;'>
                                    <input class="btnOK" type="submit" value="Show All" onclick="showHLTMenu();" style='width=100%;height=100%; margin:0; padding:0;'/>
                                </td>
                            </tbody>
                        </table>
						<div class="showM" id="HLT">
							<a href="javascript:showMenu('iHData')" class="SubCategory"> Data</a>
							<div class="showM" id="iHData">
								<table name="infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='HData' border="0">
									<tbody>
									<th style="font-size: 8pt">Release Name</th>
									
									<th style="font-size: 8pt">Tracking</th>
									<th style="font-size: 8pt">Electron</th>
									<th style="font-size: 8pt">Photon</th>
									<th style="font-size: 8pt">Muon</th>
									<th style="font-size: 8pt">Jet</th>
									<th style="font-size: 8pt">MET</th>
									<th style="font-size: 8pt">bTag</th>
									<th style="font-size: 8pt">Tau</th>
									
									<th style="font-size: 8pt">SMP</th>
									<th style="font-size: 8pt">Higgs</th>
									<th style="font-size: 8pt">Top</th>
									<th style="font-size: 8pt">Susy</th>
									<th style="font-size: 8pt">Exotica</th>
									<th style="font-size: 8pt">B</th>
									<th style="font-size: 8pt">Fwd</th>
									
									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
									</tbody>
								</table>
							</div>
							<a href="javascript:showMenu('iHFull')" class="SubCategory"> FullSim</a>

								<div class="showM" id="iHFull">
									<table name="infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='HFull' border="0">
										<tbody>
										<th style="font-size: 8pt">Release Name</th>
										
										<th style="font-size: 8pt">Tracking</th>
										<th style="font-size: 8pt">Electron</th>
										<th style="font-size: 8pt">Photon</th>
										<th style="font-size: 8pt">Muon</th>
										<th style="font-size: 8pt">Jet</th>
										<th style="font-size: 8pt">MET</th>
										<th style="font-size: 8pt">bTag</th>
										<th style="font-size: 8pt">Tau</th>
										
										<th style="font-size: 8pt">SMP</th>
										<th style="font-size: 8pt">Higgs</th>
										<th style="font-size: 8pt">Top</th>
										<th style="font-size: 8pt">Susy</th>
										<th style="font-size: 8pt">Exotica</th>
										<th style="font-size: 8pt">B</th>
										<th style="font-size: 8pt">Fwd</th>
										
										<th style="font-size: 8pt">Info</th>
										<th style="font-size: 8pt">RelMon</th>
										</tbody>
									</table>
								</div>	
							<a href="javascript:showMenu('iHFast')" class="SubCategory"> FastSim</a>
								<div class="showM" id="iHFast">

									<table name="infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='HFast' border="0">
										<tbody>
										<th style="font-size: 8pt">Release Name</th>
										
										<th style="font-size: 8pt">Tracking</th>
										<th style="font-size: 8pt">Electron</th>
										<th style="font-size: 8pt">Photon</th>
										<th style="font-size: 8pt">Muon</th>
										<th style="font-size: 8pt">Jet</th>
										<th style="font-size: 8pt">MET</th>
										<th style="font-size: 8pt">bTag</th>
										<th style="font-size: 8pt">Tau</th>
										
										<th style="font-size: 8pt">SMP</th>
										<th style="font-size: 8pt">Higgs</th>
										<th style="font-size: 8pt">Top</th>
										<th style="font-size: 8pt">Susy</th>
										<th style="font-size: 8pt">Exotica</th>
                                        <th style="font-size: 8pt">B</th>
                                        <th style="font-size: 8pt">Fwd</th>

                                        <th style="font-size: 8pt">Info</th>
										<th style="font-size: 8pt">RelMon</th>
										</tbody>
									</table>
								</div>
						</div>
                        <table border='0'>
                            <tbody>
                                <td style='margin:0; padding:0;'>
                                    <a href="javascript:showMenu('PAGs')" class="Group">PAGs</a>
                                </td>
                                <td style='margin:0; padding:0;'>
                                    <input class="btnOK" type="submit" value="Show All" onclick="showPAGSMenu();" style='width=100%;height=100%; margin:0; padding:0;'/>
                                </td>
                            </tbody>
                        </table>
						<div class="showM" id="PAGs">

						<a href="javascript:showMenu('iPData')" class="SubCategory"> Data</a>
							<div class="showM" id="iPData">
								<table name="infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='PData' border="0">
									<tbody>
									<th style="font-size: 8pt">Release Name</th>
									
									<th style="font-size: 8pt">SMP</th>
									<th style="font-size: 8pt">Higgs</th>
									<th style="font-size: 8pt">Top</th>
									<th style="font-size: 8pt">Susy</th>
									<th style="font-size: 8pt">Exotica</th>
									<th style="font-size: 8pt">B</th>
									<th style="font-size: 8pt">Fwd</th>
									
									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
                                    </tbody>
								</table>
							</div>
						<a href="javascript:showMenu('iPFull')" class="SubCategory"> FullSim</a>
							<div class="showM" id="iPFull">
								<table name="infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='PFull' border="0">
									<tbody>
									<th style="font-size: 8pt">Release Name</th>
									
									<th style="font-size: 8pt">SMP</th>
									<th style="font-size: 8pt">Higgs</th>
									<th style="font-size: 8pt">Top</th>
									<th style="font-size: 8pt">Susy</th>
									<th style="font-size: 8pt">Exotica</th>
									<th style="font-size: 8pt">B</th>
									<th style="font-size: 8pt">Fwd</th>
									
									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
									</tbody>
								</table>
							</div>
						<a href="javascript:showMenu('iPFast')" class="SubCategory"> FastSim</a>
							<div class="showM" id="iPFast">
								<table name="infoTable" class="table table-striped table-bordered table-condensed" style="border-color:black;" id='PFast' border="0">
                                    <tbody>
									<th style="font-size: 8pt">Release Name</th>
									
									<th style="font-size: 8pt">SMP</th>
									<th style="font-size: 8pt">Higgs</th>
									<th style="font-size: 8pt">Top</th>
									<th style="font-size: 8pt">Susy</th>
									<th style="font-size: 8pt">Exotica</th>
									<th style="font-size: 8pt">B</th>
									<th style="font-size: 8pt">Fwd</th>
									
									<th style="font-size: 8pt">Info</th>
									<th style="font-size: 8pt">RelMon</th>
									</tbody>
								</table>
							</div>
						</div>

				</div>
				</div>
			</div>
			<div class="span3">
				<div>
					<label style="font-family:verdana; font-size:18px">List of releases</label>
					<select id = "releaseList" style="width:200px">
					<option value="------">------</option>

					</select>
					<img src="media/add_icon.png" alt="Add" style="vertical-align: center; margin-bottom:9px;" onclick="selectList($(this).prev().get(0));" />
					<div><input name = "showAlllLitsBTN" class="btnOK" type="button" value="Show All" onclick="showAllList();"/></div>
					<label style="font-family:verdana; font-size:18px; margin-top: 15px;">Selected releases:</label>
					<br>
					<ul id="list" style="list-style:none;">
					</ul>
				</div>

			<div align="center"><input name = "historyBTN" class="btn" type="button" value="Get History" align="right" style="width:125px;" onclick="getHistory();"/></div>
			<div align="center"><input name = "historyAllBTN" class="btn" type="button" value="Get All History" align="right" style="width:125px;" onclick="getAllHistory();"/></div>
			<div align="center"><input name = "getUserListBTN" class="btn" type="button" value="Get User info" align="right" style="width:125px;" onclick="getUserList();"/></div>
			<div align="center"><input name = "addUserBTN" class="btn" type="button" value="Add User" align="right" style="width:125px;" onclick="addUser();"/></div>
			<div align="center"><input name = "rmUserBTN" class="btn" type="button" value="Remove User" align="right" style="width:125px;" onclick="removeUser();"/></div>
			</div>
		</div>
	</div>

</select>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
        <br>
         <br>
       <br> 
	</body>

	<script type="text/javascript">
        function showAllList(){
            selectedArray = []
            selectedList = document.getElementById('list');
            $(selectedList).children().each(function(data){
                selectedArray.push(this.textContent);
            });
            select = document.getElementById('releaseList');

           if ( (select.length)-1 != selectedArray.length){ //check if all elements are showed (-1 because list has ----- value)
                for(var i=0; i< select.children.length;i++){  // if not all then show all searched list elements
                    select.selectedIndex = i;
                    if (selectedArray.indexOf(select.options[i].textContent) == -1){
                        selectList(select);
                    }
                }
           }
           else{ //if all are shown -> delete them all
                $(selectedList).children().each(function(){
                   deleteChildTableRow(this);
                });
           }
        }
		function selectList(select)
		{
		  var option = select.options[select.selectedIndex];
		  var ul = select.parentNode.getElementsByTagName('ul')[0]; 
		  var choices = ul.getElementsByTagName('input');
		  if (option.value == '------')
			return;
		  for (var i = 0; i < choices.length; i++)
			if (choices[i].value == option.value)
			  return;  
		  var li = document.createElement('li');
		  var input = document.createElement('input');
		  var img = document.createElement('img');
		  var text = document.createTextNode(option.firstChild.data);
		  var url = option.firstChild.data + "=addnew&";
		  window.location.hash = window.location.hash+ url;
		  input.type = 'hidden';
		  input.value = option.value;
		  
		  img.src = "media/remove_icon.png";
		  img.alt="Remove";
		  img.style.verticalAlign = "bottom";
		  img.setAttribute('onclick', 'deleteChildTableRow (this.parentNode);');

		  li.appendChild(input);
		  li.appendChild(img);
		  li.appendChild(text);
		  li.setAttribute('name', 'selectedList');
		  li.style.backgroundColor = "#AFEEEE";
		  li.style.width = "175px";
		  
		  var relN = $(text).text();

			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "RData", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {
//                                         console.log(data[relN]);
//                                         console.log(data[relN].length);
//                                         for(elem in data[relN]){
//                                           console.log(data[relN][elem]);
//                                            createdinamictable($(eval("'#" + elem +"'")), JSON.parse(data[relN][elem]), relN, elem);
//                                          }
                                           createdinamictable($(eval("'#" + "RData" +"'")), data, relN, "RData");
                                        }
                                         },
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "HData", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "HData" +"'")), data, relN, "HData");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "PData", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "PData" +"'")), data, relN, "PData");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "RFull", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "RFull" +"'")), data, relN, "RFull");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "HFull", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "HFull" +"'")), data, relN, "HFull");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "PFull", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "PFull" +"'")), data, relN, "PFull");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "RFast", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "RFast" +"'")), data, relN, "RFast");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "HFast", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "HFast" +"'")), data, relN, "HFast");}},
					error: function() { alert("Error in data send"); }
			});
			$.ajax({
					type: 'POST',
					url: 'mainInformation',
					data: {catSubCat: "PFast", relName: relN },
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "PFast" +"'")), data, relN, "PFast");}},
					error: function() { alert("Error in data send"); }
			});
		  
		  ul.appendChild(li);
		}
	</script>
	
	<script type="text/javascript">
		function clearSelectList()
		{
			list = document.getElementById("list");
			rdata = document.getElementById("RData");
			rfull = document.getElementById("RFull");
			rfast = document.getElementById("RFast");
			hdata = document.getElementById("HData");
			hfull = document.getElementById("HFull");
			hfast = document.getElementById("HFast");
			pdata = document.getElementById("PData");
			pfull = document.getElementById("PFull");
			pfast = document.getElementById("PFast");
			while ( list.childNodes.length >= 1 )
			{
				list.removeChild( list.firstChild );
			}
			while (rdata.firstChild.nextSibling.rows[1] != null) 
			{
				deleteChildTableRow(rdata.firstChild.nextSibling.rows[1]);
			}
			while (hdata.firstChild.nextSibling.rows[1] != null) 
			{
				deleteChildTableRow(hdata.firstChild.nextSibling.rows[1]);
			}
			while (pdata.firstChild.nextSibling.rows[1] != null) 
			{
				deleteChildTableRow(pdata.firstChild.nextSibling.rows[1]);
			}
		}
	</script>
		
           <script type="text/javascript">
            $(function() {
                // When the insertform is submitted...
                $("#searchform").submit(function() {
		      //Clear release info into document
		      var url = window.location.hash;
		      var releaseSearch = document.getElementById("releaseName");
			  releaseSearch = releaseSearch.value;
		      if(window.location.hash.indexOf("srch") != -1){
			var tmp1 = window.location.hash.substring(0, url.indexOf("srch="));
			var tmp2 = window.location.hash.substring(url.indexOf("&&")+2, url.length);
			window.location.hash = tmp1+tmp2;
		      }
			  window.location.hash = window.location.hash+"srch=" +releaseSearch + "&&";
                    
                    // post the form values via AJAX...
                     $("#buttonOk").empty().html('<img src="media/loading.gif" />');
                      $.ajax({
  							type: 'POST',
  							url: 'submit',
  							data: {releaseName: $("#releaseName").val()},
							dataType: 'json',
  							success: function (data) {
								if (data.link) {
									window.location.href = data.link;
								} else {
                                                    alert(data.length +" Releases were found. Showing them in List of releases");
                            						document.getElementById("releaseList").innerHTML = "";
                            						appendOptionLast(data);
                            						$("#buttonOk").css('display', 'none');
								}
                           				 },
                           	error: function() { alert("Error in data send") }
                           });
                    return false ;
                    });
            });

	</script>
	
	<!--Create and perform action with table-->

<script  type="text/javascript">
function createdinamictable(tbody, data1, releaseName, subCat){
  var colnumb;
  var keys;
  if (subCat == 'RData'|| subCat == 'RFull' || subCat == 'RFast'){
    colnumb = 17;
    keys = ["TK", "ECAL", "HCAL", "DT", "CSC", "RPC", "TRACKING", "ELECTRON", "PHOTON", "MUON", "JET", "MET", "BTAG", "TAU",  "SUMMARY", "RELMON"];
  }
  if (subCat == 'HData'||subCat == 'HFull'||subCat == 'HFast'){
    colnumb = 18;
    keys = ["TRACKING", "ELECTRON", "PHOTON", "MUON", "JET", "MET", "BTAG", "TAU", "SMP", "HIGGS", "TOP", "SUSY", "EXOTICA", "B", "FWD", "SUMMARY", "RELMON"];
  }
  if (subCat == 'PData'||subCat == 'PFull'||subCat == 'PFast'){
    colnumb = 10;
    keys = ["SMP", "HIGGS", "TOP", "SUSY", "EXOTICA", "B", "FWD", "SUMMARY", "RELMON"];
  }
  var text;
  if(tbody == null || tbody.length <1) return;
  for(var i = 1; i <= 1; i++){
    var trow = $("<tr>");
    for(var j = 0; j < colnumb; j++){
      if(i==1 && j==0){
      text = releaseName;
	  $("<td>")
	    .addClass("tableCell")
	    .text(releaseName)
	    .attr('id', releaseName)
	    .data("col", j)
	    .data("row",i)
	    .appendTo(trow);
	}
	else if (j == keys.length){
	    if (data1["RelMon"] != null){
            src = "<a href='"+data1["RelMon"]+"'> <img src='media/arrowlink.gif'></a>"
        } else{
            src = "<a ></a>"
        }
        $("<td>")
            .addClass("tableCell")
            .append(src)
            .attr('value', keys[j-1])
            .data("col", j)
            .data("row",i)
            .appendTo(trow);  
	}
	else if (j == keys.length-1){ //for Info column
        src = "<a> <img src='media/help.gif'></a>"
        $("<td>")
            .addClass("tableCell")
            .append(src)
            .attr('value', keys[j-1])
            .attr('onclick', 'javascript:showModal("'+subCat+'", this)')
            .data("col", j)
            .data("row",i)
            .appendTo(trow);  
    }
	else{
	  if (! isEmpty(data1)) {
	  	return;
	  } else {
	var headValue = $(tbody)[0];
	var tmpchild = $(headValue).children()[0];
	headValue = $(tmpchild).children()[0];
	var ilgiauchild = $(headValue).children();
	var key = ilgiauchild[j].textContent.toUpperCase();
	if (key == "TRACKER"){
       key = "TK"
    }
    if (typeof data1[key] === 'undefined'){
        text = null;
        comment = null;
    }
    else{
        text = data1[key][0];
        comment = data1[key][1];
    }
	var src

	switch(text){
	case "OK" : 
	      src = '<a href="#" rel="tooltip" title="'+comment +'">'
	      src +=  "<img src='media/choice-yes.gif'/>";
	      src += "</a>"
	      break;
	case "FAILURE":
          src = '<a href="#" rel="tooltip" title="'+comment +'">'
	      src +=  "<img src='media/choice-no.gif'/>";
	      src += "</a>"
	      break;
	case "CHANGES EXPECTED":
          src = '<a href="#" rel="tooltip" title="'+comment +'">'
	      src +=  "<img src='media/target.gif'/>";
	      src += "</a>"
	      break;
	case "IN PROGRESS":
          src = '<a href="#" rel="tooltip" title="'+comment +'">'
	      src +=  "<img src='media/wip.gif'/>";
	      src += "</a>"
	      break;
	case "OK TO BE SIGNED-OFF BY THE VALIDATORS":
          src = '<a href="#" rel="tooltip" title="'+comment +'">'
	      src +=  "<img src='media/thumbs-up.gif'/>";
	      src += "</a>"
	      break;
	case "FAILURE TO BE SIGNED-OFF BY THE VALIDATORS":
          src = '<a href="#" rel="tooltip" title="'+comment +'">'
	      src +=  "<img src='media/thumbs-down.gif'/>";
	      src += "</a>"
	      break;
	default:
	      src = "<img src='media/minus.gif'/>";
	      break;
	}
	  }
	$("<td>")
	    .addClass("tableCell")
	    .append(src)
	    .attr('value', key)
	    .attr('onclick', 'javascript:showModal("'+subCat+'", this)')
	    .data("col", j)
	    .data("row",i)
	    .appendTo(trow);  
	}
      } 
      trow.appendTo(tbody);
    }
  }
  
  function isEmpty(object) {
	for(var i in object) {
		return true;
	}
	return false;
  }
  
</script>

<script>
function linkify(inputText) {
    var replaceText, replacePattern1, replacePattern2, replacePattern3;

    //URLs starting with http://, https://, or ftp://
    replacePattern1 = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
    replacedText = inputText.replace(replacePattern1, '<a href="$1" target="_blank">$1</a>');

    //URLs starting with "www." (without // before it, or it'd re-link the ones done above).
    replacePattern2 = /(^|[^\/])(www\.[\S]+(\b|$))/gim;
    replacedText = replacedText.replace(replacePattern2, '$1<a href="http://$2" target="_blank">$2</a>');
    
    return replacedText.replace(/\n/g,"<br>")  //return formatted links with new line to <br> as HTML <P> tag skips '\n'    
}

function showModal(subcategory, obj){
	var statName = obj.value;
	if (statName == "TK"){
        statName = "TRACKER"
    }else if(statName == "Info"){
        statName = "SUMMARY"
    }
	document.getElementById('valStatName').textContent = ("name", statName);
	var rn = $(obj).parent()[0];
	var releaseName = $(rn).children()[0].textContent;
	var column = $(obj).data("col");
	var reiksm = $(obj).parent().parent()[0];
	var tmpval = $(reiksm).children()[0];
	var statvalue = $(tmpval).children()[column].textContent;
	if (statvalue.toUpperCase() == "TRACKER"){
	    statvalue = "TK"
	}else if(statvalue.toUpperCase() == "INFO"){
        statvalue = "SUMMARY"
	}
	var category;
	var releaseDetails = ["VALIDATION_STATUS","USER_NAME","LINKS","COMMENTS","META_DATE", "RELEASE_NAME"];
	switch (subcategory[0]){
	 case "R":
	      category = "Reconstruction";
	      break;
	 case "H":
	      category = "HLT";
	      break;
	 case "P":
	      category = "PAGs";
	      break;
	 default:
	      category = "";
	      break;
	}
	var subCat = subcategory.substring(1,subcategory.length);
	switch(subCat){
	  case "Full":
		subCat = subCat + "Sim";
		break;
	  case "Fast":
		subCat=subCat + "Sim";
	  default:
		break;
	}
	$.ajax({
		type: 'POST',
            url: 'getDetailInformation',
        	data: {catSubCat: subcategory, relName: releaseName, state: statvalue.toUpperCase() },
		dataType: 'json',
            success: function (data) {	if (data.link) {
                                                  window.location.href = data.link;
                                        } else {
						$('#myModal').bind('show', function () { 
				document.getElementById('modalHeaderTree').innerHTML = category +"/"+subCat;
				document.getElementById('author').innerHTML = data[releaseDetails[1]];
				document.getElementById('valStat').innerHTML = data[releaseDetails[0]];
				document.getElementById('comments').innerHTML = data[releaseDetails[3]];
				document.getElementById('comdate').innerHTML = data[releaseDetails[4]];
				document.getElementById('modalReleaseName').innerHTML = data[releaseDetails[5]];
				linksElem = document.getElementById('links');
				linksElem.innerHTML = "";
				linksData = data[releaseDetails[2]];
				if (linksData != null){
                    linksElem.innerHTML = linkify(linksData);
                }
			}),
				$('#myModal').modal({backdrop: 'static'},'toggle');
				//.css({
                //width: '90%',   //uncomment to have a bigger size modal
                //'margin-left': function () {
                //return -($(this).width() / 2);
               // }
               // });
					}},
            error: function() { alert("Error in data send"); }
	});
}
</script>

<script>
function showMenu(category){
	var whichcategory = document.getElementById(category);
	var url = window.location.hash;
	if(whichcategory.className == "showM"){
		whichcategory.className="hideM";
		if(url.indexOf(category) ==-1){
		  window.location.hash = window.location.hash + category + "=show&";
		  } else{
		    var tmp1 = window.location.hash.substring(0, url.indexOf(category));
		    var tmp2 = window.location.hash.substring(url.indexOf(category)+category.length+6, url.length);
		    window.location.hash = tmp1+tmp2;
		    }
	}
	else{
	whichcategory.className="showM";
	var tmp1 = window.location.hash.substring(0, url.indexOf(category));
	var tmp2 = window.location.hash.substring(url.indexOf(category)+category.length+6, url.length);
	window.location.hash = tmp1+tmp2;
    }
}
</script>
<script>
function deleteChildTableRow (obj){
  var name = obj.textContent;
  var url = window.location.hash;
  var tmp1 = window.location.hash.substring(0, url.indexOf(name));
  var tmp2 = window.location.hash.substring(url.indexOf(name)+name.length+8, url.length);
  window.location.hash = tmp1+tmp2;
  obj.parentNode.removeChild(obj);

//delete information of release from all tables;
  for(i=0; i<9; i++){
    var row = document.getElementById(obj.textContent);
    if(row !=null){
      var elem = row.parentNode; 
      $(elem).remove();
    }
  }      
}
</script>

<script>
  function addRelease(){
  var modal = document.getElementById('newReleaseModal');
  clearModal(modal);
  document.getElementById('newCatName').value = "------";
  document.getElementById('editSubCategories').value = "Data";
  document.getElementById('RelMon_URL').value = "";
    $('#newReleaseModal').bind('show', function (){});
    $('#newReleaseModal').modal('toggle');
    //.css({
    //            width: '90%',
    //            'margin-left': function () {  //uncomment for bigger modal
    //            return -($(this).width() / 2);
    //           }
    //            });
}

function addStats(obj){
clearModal2(obj);
var inp = obj.textContent;
var release = $(obj).val();
var keys;
if(release.toUpperCase() == "RECONSTRUCTION")
    keys = ["CSC", "TAU", "TRACKING", "BTAG", "JET", "ECAL", "RPC", "PHOTON", "MUON", "MET", "ELECTRON", "TK", "HCAL", "DT", "SUMMARY"];
if(release.toUpperCase() == "HLT")
    keys = ["TAU", "JET", "HIGGS", "TOP", "MUON", "PHOTON", "MET", "ELECTRON", "EXOTICA", "SUSY", "BTAG", "B", "TRACKING", "FWD", "SMP", "SUMMARY"];
if(release.toUpperCase() == "PAGS")
    keys = ["B", "HIGGS", "FWD", "TOP", "SMP", "EXOTICA", "SUSY", "SUMMARY"];
if(release == "------")
    keys = 0;
if(release.toUpperCase() == "ALL")
    keys = 0;

for(i=0; i<keys.length; i++){
	  var newdiv = document.createElement('div');
	  newdiv.setAttribute('name', keys[i]);
          newdiv.innerHTML = keys[i] +" "+
	      "<select name='mydropdown' onchange='displayExtraInfo(this);'>" +
	      "<option selected='selected' value='NOT YET DONE'>NOT YET DONE</option>" +
	      "<option value='OK'>OK</option>"+
	      "<option value='CHANGES EXPECTED'>CHANGES EXPECTED</option>"+
	      "<option value='IN PROGRESS'>IN PROGRESS</option>"+
	      "<option value='FAILURE'>FAILURE</option>"+
	      "<option value='OK TO BE SIGNED-OFF BY THE VALIDATORS'>OK TO BE SIGNED-OFF BY THE VALIDATORS</option>"+
	      "<option value='FAILURE TO BE SIGNED-OFF BY THE VALIDATORS'>FAILURE TO BE SIGNED-OFF BY THE VALIDATORS</option>"+
	      "</select>"+
	      "<div class='showM' name='detailInfoTab'>"+
		    "<form>"+
			"Author name:<input type='text' id='releaseCommentAuthor'/><br/>"+
			"Comment:</br><textarea rows='3' name='comment' cols='24' style= 'width: 454px; height:129px;'></textarea><br/>"+
			"Links:</br><textarea id='releaseCommentLinks' style='width: 362px; height:60px;'> </textarea><br/>"+
			"<input name = 'detailOKBTN' class='btn' type='button' value='OK' onclick='hideExtraInfo(this);'/>" +
		    "</form>"+
	      "</div>";
          document.getElementById('newStats').appendChild(newdiv)
  }
}
function displayExtraInfo(obj){
    var stuff= obj.nextElementSibling;
    stuff.className="hideM";
}
function hideExtraInfo(obj){
    var stuff = $(obj).parent().parent()[0];
    stuff.className="showM";
}
function addNewRelease(obj){
    objCpy = obj;
   var stats = $(obj).parent();  //get modal footer object
   var stasChild = $(stats).parent()[0]; //get whole modal object
   stats = $(stasChild).children()[0]; //get modal HEADER object

    stasChild= $(stats).children()[0]; //get FORM object from modal
  if(stasChild[0].value == "------"){
    alert("You must select release Category!");     
      elem = document.getElementById('newModalSaveBTN');
      elem.removeAttribute('data-dismiss', 'modal');
    return false;
  }
var Category = stasChild[0].value;
var SubCategory = stasChild[1].value;
var releasName = stasChild[2].value;

var relMonURL = stasChild[3].value;
var statName;
var stuff;

var newStatList= new Array();
var newStatVaList= new Array();

var newStatComments = new Array();
var newStatAuthors = new Array();
var newStatLinks = new Array();

var userNAME = document.getElementById("userNameButton").textContent;
var errorInAdding = false;
var errorMessage;

var statsEL = stasChild.lastElementChild;
    stats = $(statsEL).children();
    for(i=0; i< stats.length; i++){
      statName = stats[i];
      var statusValue = stats[i];
      statusValue = $(statusValue).children()[0];
      stuff = $(statName).children()[1];
      stuff = $(stuff).children()[0];
      var tmp = statName.getAttribute("name");
      newStatList.push(tmp);
      newStatVaList.push(statusValue.value);
  
      newStatAuthors.push(stuff[0].value);
      newStatComments.push(stuff[1].value);
      newStatLinks.push(stuff[2].value);
    }
    if (releasName.length > 20) {
        alert("Release name too long!!! Max 20 chars.");
        elem = document.getElementById('newModalSaveBTN');
        elem.removeAttribute('data-dismiss', 'modal'); 
        return false;
    }
    elem = document.getElementById('newModalSaveBTN');
    elem.setAttribute('data-dismiss', 'modal'); 
    relNametoPut = "";
    wasNotAdded = false;
    var mailId;
    var msgIds;
    $('#loadModal').modal('toggle');
    //method to get new e-mail ID for email SPAMMING!
    $.ajax({
            type: 'GET',
            url: 'getMultipleMsgId',
            async: false,
            data: {},
            dataType: 'json',
            success: function (data){
                mailId = data;
                },
            error: function() {alert("Error in data send");}
        });
    if(Category == "All"){
	  var categoryList = ["Reconstruction","HLT","PAGs"];
	  if(SubCategory.toUpperCase() == "ALL"){ //send info for AllxAll
	    var subCatList = ["Data", "FullSim", "FastSim"];
	    //set default values for sending data
	    for(i=0; i<categoryList.length;i++){
	      if(categoryList[i] == "Reconstruction"){
	        defaultKeys = ["CSC", "TAU", "TRACKING", "BTAG", "JET", "ECAL", "RPC", "PHOTON", "MUON", "MET", "ELECTRON", "TK", "HCAL", "DT", "SUMMARY"];
	        msgIds = mailId[0]+","+mailId[2]; // send to RelVal and Muon Hypernews
	       }
	      if(categoryList[i] == "HLT"){
	        defaultKeys = ["TAU", "JET", "HIGGS", "TOP", "MUON", "PHOTON", "MET", "ELECTRON", "EXOTICA", "SUSY", "SMP", "FWD", "BTAG", "TRACKING", "B", "SUMMARY"];
	        msgIds = mailId[0]+","+mailId[1]; // send to RelVal and HLT Hypernews
	      }
	      if(categoryList[i] == "PAGs"){
	        defaultKeys = ["B", "HIGGS", "FWD", "TOP", "SMP", "EXOTICA", "SUSY", "SUMMARY"];
	        msgIds = mailId[0]; // send to RelVal Hypernews
	      }
	      for(k=0; k<defaultKeys.length; k++){
	        newStatList.push(defaultKeys[k]);
	        newStatVaList.push("NOT YET DONE");
	        newStatComments.push("");
	        newStatAuthors.push("");
	        newStatLinks.push("");
	      }
              for(j=0;j<subCatList.length;j++){
		if(relNametoPut == releasName){
			wasNotAdded = false;
		}
		else{
			relNametoPut = releasName;
			wasNotAdded = true;
		}


		    $.ajax({
					type: 'POST',
					url: 'addNewRelease',
					data: $.param({'sendMail': wasNotAdded, 'categ': categoryList[i], 'subCat': subCatList[j], 'relName': releasName, 'statusNames': newStatList, 'statusValues': newStatVaList,
					'statComments': newStatComments, 'statAuthors': newStatAuthors, 'statLinks': newStatLinks, 'mailID': msgIds, 'relMonURL': relMonURL}, true),
					dataType: 'json',
					async: false,
					success: function (data) { if (data.link) {
                                                			  window.location.href = data.link;
                                   				     };
                                               if (data != "New release added successfuly"){
                                                    errorInAdding = true;
                                                    errorMessage = data;
                                               };
                                   				     },
					error: function() {clearModal(objCpy); document.getElementById('newCatName').value = "------"; }
			});
	      }
	      //clear array values
	    	newStatList.length = 0;
	        newStatVaList.length = 0;
	        newStatComments.length = 0;
	        newStatAuthors.length = 0;
	        newStatLinks.length = 0;
	    }
	  }
	 if(SubCategory.toUpperCase() != "ALL"){ //send info for AllxOne
	   for(i=0; i< categoryList.length; i++){
	      if(categoryList[i] == "Reconstruction"){
	        defaultKeys = ["CSC", "TAU", "TRACKING", "BTAG", "JET", "ECAL", "RPC", "PHOTON", "MUON", "MET", "ELECTRON", "TK", "HCAL", "DT", "SUMMARY"];
	        msgIds = mailId[0]+","+mailId[2]; // send to RelVal and Muon Hypernews
	      }
	      if(categoryList[i] == "HLT"){
	        defaultKeys = ["TAU", "JET", "HIGGS", "TOP", "MUON", "PHOTON", "MET", "ELECTRON", "EXOTICA", "SUSY", "SMP", "FWD", "BTAG", "TRACKING", "B", "SUMMARY"];
	        msgIds = mailId[0]+","+mailId[1]; // send to RelVal and HLT Hypernews
	      }
	      if(categoryList[i] == "PAGs"){
	        defaultKeys = ["B", "HIGGS", "FWD", "TOP", "SMP", "EXOTICA", "SUSY", "SUMMARY"];
	        msgIds = mailId[0]; // send to RelVal Hypernews
	      }
	      for(k=0; k<defaultKeys.length; k++){
	        newStatList.push(defaultKeys[k]);
	        newStatVaList.push("NOT YET DONE");
	        newStatComments.push("");
	        newStatAuthors.push("");
	        newStatLinks.push("");
	      }
                if(relNametoPut == releasName){
                        wasNotAdded = true;
                }
                else{
                        relNametoPut = releasName;
                        wasNotAdded = false;
                }
      $.ajax({
			type: 'POST',
			url: 'addNewRelease',
			data: $.param({'sendMail': wasNotAdded, 'categ': categoryList[i], 'subCat': SubCategory, 'relName': releasName, 'statusNames': newStatList, 'statusValues': newStatVaList,
			'statComments': newStatComments, 'statAuthors': newStatAuthors, 'statLinks': newStatLinks, 'mailID': msgIds, 'relMonURL': relMonURL}, true),
			dataType: 'json',
			async: false,
			success: function (data) { if (data.link) {
                                   			  window.location.href = data.link;
                           				     };
                                       if (data != "New release added successfuly"){
                                                    errorInAdding = true;
                                                    errorMessage = data;
                                                    };
                           				     },
			error: function() {clearModal(objCpy); document.getElementById('newCatName').value = "------"; }
		});  
      //clear array values
      newStatList.length = 0;
      newStatVaList.length = 0;
      newStatComments.length = 0;
      newStatAuthors.length = 0;
      newStatLinks.length = 0;
	   }
	 }
	}
	if(Category != "All"){
	 switch(Category){
        case "Reconstruction":
          msgIds = mailId[0]+","+mailId[2]; // send to RelVal and Muon Hypernews
          break;
        case "HLT":
          msgIds = mailId[0]+","+mailId[1]; // send to RelVal and HLT Hypernews
          break;
        default:
          msgIds = mailId[0]; // send to RelVal Hypernews
	 }
	  if(SubCategory.toUpperCase() == "ALL"){ //send info for OneXAll
		var subCatList = ["Data", "FullSim", "FastSim"];
		for(j=0;j<subCatList.length; j++){
		if(relNametoPut == releasName){
                        wasNotAdded = true;
                }
                else{
                        relNametoPut = releasName;
                        wasNotAdded = false;
                }
          $.ajax({
			type: 'POST',
			url: 'addNewRelease',
			data: $.param({'sendMail': wasNotAdded, 'categ': Category, 'subCat': subCatList[j], 'relName': releasName, 'statusNames': newStatList, 'statusValues': newStatVaList,
			'statComments': newStatComments, 'statAuthors': newStatAuthors, 'statLinks': newStatLinks, 'mailID': msgIds, 'relMonURL': relMonURL}, true),
			dataType: 'json',
			async: false,
			success: function (data) { if (data.link) {
                                   			  window.location.href = data.link;
                           				     };
                                        if (data != "New release added successfuly"){
                                                    errorInAdding = true;
                                                    errorMessage = data;
                                                    };
                           				     },
			error: function() {clearModal(objCpy); document.getElementById('newCatName').value = "------"; }
		  }); 
		}
	  }
	}
    if(Category != "All" && SubCategory.toUpperCase() != "ALL"){
      switch(Category){
        case "Reconstruction":
          msgIds = mailId[0]+","+mailId[2]; // send to RelVal and Muon Hypernews
          break;
        case "HLT":
          msgIds = mailId[0]+","+mailId[1]; // send to RelVal and HLT Hypernews
          break;
        default:
          msgIds = mailId[0]; // send to RelVal Hypernews
      }
	  $.ajax({ //send info OneXOne
			  type: 'POST',
			  url: 'addNewRelease',
			  data: $.param({'sendMail': wasNotAdded, 'categ': Category, 'subCat': SubCategory, 'relName': releasName, 'statusNames': newStatList, 'statusValues': newStatVaList,
			  'statComments': newStatComments, 'statAuthors': newStatAuthors, 'statLinks': newStatLinks, 'mailID': msgIds, 'relMonURL': relMonURL}, true),
			  dataType: 'json',
			  async: false,
			  success: function (data) { if (data.link) {
												window.location.href = data.link;
											  };
										if (data != "New release added successfuly"){
                                                    errorInAdding = true;
                                                    errorMessage = data;
                                                    };
											  },
			  error: function() {clearModal(objCpy); document.getElementById('newCatName').value = "------"; }
			});  
		}
	if (errorInAdding == false){
	   if (Category == "All"){
	     msgIds = mailId[0]+","+mailId[1]+","+mailId[2];
	   }else{
	     switch(SubCategory){
	       case "Reconstruction":
	         msgIds = mailId[0]+","+mailId[2];
	         break;
	       case "HLT":
	         msgIds = mailId[0]+","+mailId[1];
             break;
           default:
             msgIds = mailId[0];
	     }
	   }
	   msgSubject = "New release "+releasName+" added"
	   msgText = "New release: "+releasName +" was added by "+userNAME+". Please check it!"
	   $.ajax({
	     type: 'POST',
	     url: 'sendMail',
	     data: $.param({'messageText':msgText,'emailSubject': msgSubject,'org_message_ID':"",'new_message_ID':msgIds, 'username' : userNAME}, true),
	     dataType: 'json',
	     async: false,
	     success: function(data){alert(data);},
	     error: function() {}
	   });
	   }
	  else{
	     alert(errorMessage);
	  }
	 $('#loadModal').modal('hide');
     return false;
}

function clearModal(obj){
   var stats = $(obj).parent();  //get modal footer object
   var stasChild = $(stats).parent()[0]; //get whole modal object
   stats = $(stasChild).children()[0]; //get modal HEADER object
   objCpy = stats;
   var stuff = $(objCpy).parent();
   var kl = document.getElementById('newStats');

    $(kl).children().each(function(){
      $(this).remove();
    });

    document.getElementById('newCatName').value="";
    document.getElementById('newRelName').value="";
    document.getElementById('editSubCategories').value=""; 
    stuff = document.getElementById('editSubCategories');   
    var dataValues = $(stuff).children();
    for(i=0; i<dataValues.length; i++){
      if(dataValues[i].value == "Data"){ //TO DO: clear option to preselect- doesnt clear value?
	 dataValues[i].setAttribute('selected','selected');
	i= dataValues.length;
      }
    }
}

function clearModal2(obj){
     var stats = $(obj).parent();//get modal footer object
     var stasChild = $(stats).parent()[0]; //get whole modal object
     stats = $(stasChild).children()[0]; //get modal HEADER object
     objCpy = stats;
     var stuff = $(objCpy).parent();
     var kl = document.getElementById('newStats');

     $(kl).children().each(function(){
        $(this).remove();
     });

}

function editModalInfo(){
    var obj = document.getElementById('modalHeaderTree').textContent;

    var statusName = document.getElementById('valStatName').textContent;
    if (statusName == "TRACKER"){
        statusName = "TK"
    }
    var category = obj.substring(0, obj.indexOf('/'));
    var subCategory = obj.substring(obj.indexOf('/')+1, obj.length);

    var gali = true;

    $.ajax({
               type: 'POST',
               url: 'getLogedUserName',
               data: {},
               dataType: 'json',
               success: function(data) { if (data.link) {
                                                  window.location.href = data.link;
                                        } else {document.getElementById('modalEditAuthor').textContent = data[1];}},
               error: function() { alert("Error in data send") }
         });

    $('#editModal').bind('show', function (){});
	                                            $('#editModal').modal('toggle');
	          //                                  .css({
              //  width: '90%',
              //  'margin-left': function () {
              //  return -($(this).width() / 2);
              //  }
              //  });
	                                            setEditModal();
	                                            elem = document.getElementById('btnEditInfo');
	                                            elem.setAttribute('data-dismiss', 'modal');
	                                            return true;

}

function setEditModal(){
   var obj = document.getElementById('valStat').textContent;
   var stuff = document.getElementById('editDropdown');
   var dataValues = $(stuff).children();
    for(i=0; i<dataValues.length; i++){
      if(dataValues[i].text == obj){
	 dataValues[i].setAttribute('selected','selected');
	 dataValues[i].value = obj;
	i= dataValues.length;
      }
    }
 
   var tmpInfo = document.getElementById('modalReleaseName').innerHTML
   document.getElementById('modalEditReleaseName').textContent = tmpInfo;
   document.getElementById('modalEditComments').value = document.getElementById('comments').innerHTML;
   document.getElementById('modalEditLinks').value = document.getElementById('links').textContent;
   tmpInfo = document.getElementById('modalHeaderTree').textContent;
   catSubCat = tmpInfo.split('/')
   statusKind = document.getElementById('valStatName').textContent;
   if (catSubCat[0] == 'HLT'){
      document.getElementById('hn-address').textContent = 'hn-cms-trigger-performance@cern.ch';
   }
   else if ((catSubCat[0] == 'Reconstruction') && (statusKind == 'MUON')){
      document.getElementById('hn-address').textContent = 'hn-cms-muon-object-validation@cern.ch';
   }
   else{
      document.getElementById('hn-address').textContent = 'hn-cms-relval@cern.ch';
   }
   document.getElementById('editModalHeaderTree').textContent = tmpInfo;  
}

function notEmpty(){
  elem = document.getElementById('editDropdown');
	if(elem.value.length == 0){
		alert("Status value MUST be selected");
		elem.focus(); // set the focus to this input
		return false;
	}
  clearEditModal();
  elem = document.getElementById('btnSave');
  elem.setAttribute('data-dismiss', 'modal');
  return true;
}
 function updateTableValues(relName, catSubCatName){
    var table = document.getElementById(catSubCatName);
    tbBody = $(table).children(); //get <tbody> tag obj
    tableId = table.id; //get <table> id name as a string
    $(tbBody).children().each(function(){
          if($(this).children()[0].id == relName)
                  $(this).remove();
          });
  $.ajax({
                type: 'POST',
                url: 'mainInformation',
                data: {catSubCat: catSubCatName, relName: relName },
                success: function (data) {createdinamictable($(eval("'#" + catSubCatName +"'")), data, relName, catSubCatName)},
                error: function() { alert("Error in data send"); }
  });
}

function clearEditModal(){
  var releasName = document.getElementById('modalEditReleaseName').textContent;
  var editAuthor = document.getElementById('modalEditAuthor').textContent;
  var editComments = document.getElementById('modalEditComments').value;
  var editSatusValue = document.getElementById('editDropdown').value;
  var editLinks = document.getElementById('modalEditLinks').value;
  var cat = document.getElementById('modalHeaderTree').textContent;
  var tmpCategoryName = cat[0];
  var tmpSubCatVal = cat.substring(cat.indexOf('/')+1,cat.indexOf('/')+5);
  cat = tmpCategoryName + tmpSubCatVal;  
  var statusName = document.getElementById('valStatName').textContent;
  if (statusName == "TRACKER"){
      statusName = "TK"
  }
  var userName = "";
  var userFullName = "";
      $.ajax({
               type: 'POST',
               url: 'getLogedUserName',
               data: {},
               async: false,
               dataType: 'json',
               success: function(data) {
                    userName = data[0];
                    userFullName = data[1];
               },
               error: function() { alert("Error in data send") }
         });
 $.ajax({
					type: 'POST',
					url: 'updateReleaseInfo',
					data: {comentAuthor: userFullName, stateValue: editSatusValue, relName: releasName, newComment: editComments, newLinks: editLinks, catSubCat: cat, statusKind: statusName, userName: userName},
					dataType: 'json',
                                        success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {alert(data); clearEditModalValues(); updateTableValues(releasName, cat);}},
					error: function() {alert("Data send failure"); clearEditModalValues();}
			});



}
function clearEditModalValues(){
  document.getElementById('modalEditReleaseName').textContent="";
  document.getElementById('modalEditAuthor').textContent="";
  document.getElementById('modalEditComments').value="";
  document.getElementById('modalEditLinks').value="";
  document.getElementById('valStatName').textContent="";
  var stuff = document.getElementById('editDropdown');
  stuff.value="";
  var dataValues = $(stuff).children();
  for(i=0; i<dataValues.length; i++){
	 dataValues[i].removeAttribute('selected',0); 
   }
}

function closedNewReleaseModal(obj){
  clearModal(obj);
  document.getElementById('newCatName').value = "------";
  document.getElementById('modalEditReleaseName').value=""
  document.getElementById('modalEditAuthor').value=""
  document.getElementById('modalEditComments').value=""
  document.getElementById('modalEditLinks').value="" //TO-DO how to delete seleted list value//
  var stuff = document.getElementById('editDropdown');
  var dataValues = $(stuff).children();
  for(i=0; i<dataValues.length; i++){
	 dataValues[i].removeAttribute('selected',0); 
  }
  var elem = document.getElementById('btnSave');
  elem.removeAttribute('data-dismiss', 0);
}
</script>

<script>
function appendOptionLast(data){
  var select = document.getElementById("releaseList");
  var lngth = select.options.length;
	
  if(lngth == 0){
    select.options[lngth] = new Option('------');
    select.options[lngth].value = '------';
  }
  for(index in data){
    	select.options[select.options.length] = new Option(data[index], index);
  }
}

function getHistory(){
  var modal = document.getElementById('historyModal');
  var list = document.getElementById('list');
  var tmp;
  clearHistoryModal();

  $('#historyModal').bind('show', function (){
      });
  $('#historyModal').modal('toggle');   

    $(list).children().each(function(){
	var li = document.createElement('li');
	var tmp = document.createElement('input');
	var text = document.createTextNode(this.textContent);
	tmp.setAttribute('type', 'checkbox');
	tmp.appendChild(text);
	li.appendChild(tmp);
	li.appendChild(text);    
	tmp = document.getElementById('historyList');
	tmp.appendChild(li);
    });
  list = document.getElementById('recoStatList');
}

function getHistoryBtn(){
  var statusList= [""];
  var subCatList= [""];
  var recoStatsChecked = [""];
  var hltStatsChecked = [""];
  var pagsStatsChecked = [""];
  var releaseList = [""];

    $(document.getElementById('recoStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      if(stuff.checked == true){
	var catSub= stuff.getAttribute("id");
	recoStatsChecked.push(catSub);
      }  
    });
    $(document.getElementById('hltStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      if(stuff.checked == true){
	var catSub= stuff.getAttribute("id");
	hltStatsChecked.push(catSub);
      }
    });
    $(document.getElementById('pagsStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      if(stuff.checked == true){
	var catSub= stuff.getAttribute("id");
	pagsStatsChecked.push(catSub);
      }
    });
    $(document.getElementById('historyList')).children().each(function(){
      var stuff = $(this).children()[0];
      if(stuff.checked == true){
	var catSub= this.textContent;
	releaseList.push(catSub);
      }
    });
    $(document.getElementById('subCatList')).children().each(function(){
      var stuff = $(this).children()[0];
      if(stuff.checked == true){
	var catSub= stuff.getAttribute("id");
	subCatList.push(catSub);
      }
    });

window.open('showHistory?' + $.param({'statusList': statusList, 'subCatList': subCatList, 'recoStatsChecked': recoStatsChecked, 'hltStatsChecked': hltStatsChecked, 'pagsStatsChecked': pagsStatsChecked, 'releaseList': releaseList}, true));
}

function clearHistoryModal(){
    $(document.getElementById('recoStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    $(document.getElementById('hltStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    $(document.getElementById('pagsStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    $(document.getElementById('historyList')).children().each(function(){
      $(this).remove();
    });
    $(document.getElementById('subCatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
}

function addReleaseURL(releaseURLName){
  var ul = document.getElementById('list'); 
  var choices = ul.getElementsByTagName('input');
  var li = document.createElement('li');
  var input = document.createElement('input');
  var img = document.createElement('img');
  var text = document.createTextNode(releaseURLName);
  input.type = 'hidden';
  input.value = releaseURLName
	  
  img.src = "media/remove_icon.png";
  img.alt="Remove";
  img.style.verticalAlign = "bottom";
  img.setAttribute('onclick', 'deleteChildTableRow(this.parentNode);');

  li.appendChild(input);
  li.appendChild(img);
  li.appendChild(text);
  li.setAttribute('name', 'selectedList');
  li.style.backgroundColor = "#AFEEEE";
  li.style.width = "175px";
		  
  var relN = $(text).text();

  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "RData", relName: relN },
		dataType: 'json',
		success: function (data) { if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "RData" +"'")), data, relN, "RData");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "HData", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "HData" +"'")), data, relN, "HData");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "PData", relName: relN },
		dataType: 'json',
		success: function (data) { if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "PData" +"'")), data, relN, "PData");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "RFull", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "RFull" +"'")), data, relN, "RFull");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "HFull", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "HFull" +"'")), data, relN, "HFull");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "PFull", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "PFull" +"'")), data, relN, "PFull");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "RFast", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "RFast" +"'")), data, relN, "RFast");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "HFast", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "HFast" +"'")), data, relN, "HFast");}},
		error: function() { alert("Error in data send"); }
  });
  $.ajax({
		type: 'POST',
		url: 'mainInformation',
		data: {catSubCat: "PFast", relName: relN },
		dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {createdinamictable($(eval("'#" + "PFast" +"'")), data, relN, "PFast");}},
		error: function() { alert("Error in data send"); }
  });
		  
  ul.appendChild(li);
}

function getCookie(c_name)
{
var i,x,y,ARRcookies=document.cookie.split(";");
for (i=0;i<ARRcookies.length;i++)
{
 x=ARRcookies[i].substr(0,ARRcookies[i].indexOf("="));
 y=ARRcookies[i].substr(ARRcookies[i].indexOf("=")+1);
 x=x.replace(/^\s+|\s+$/g,"");
 if (x==c_name)
 {
 return unescape(y);
 }
 }
}
function createCookie(name,value,days) {
    if (days) {
        var date = new Date();
        date.setTime(date.getTime()+(days*24*60*60*1000));
        var expires = "; expires="+date.toGMTString();
    }
    else var expires = "";
    document.cookie = name+"="+value+expires+"; path=/";
}

function eraseCookie(name) {
    createCookie(name,"",-1);
}

$(document).ready(function(){
  var coockieValue = getCookie("redirectionLink");
  if (coockieValue !=null){
  window.location.hash = window.location.hash + coockieValue.substring(1,coockieValue.length-1);
  }
  eraseCookie("redirectionLink");
  var i, variables = window.location.hash.substring(1).split('&');
  var tmp = window.location.hash.substring(1);
  tmp = tmp.split('&');

  if (variables.length > 1) {
      for (i = 0; i < variables.length; i++) {
	  keyValuePair = variables[i].split('=');
	    if(keyValuePair[1] == 'show'){
	      showMenuURL(keyValuePair[0]);
	    }
	    if(keyValuePair[1] == 'addnew'){
		addReleaseURL(keyValuePair[0]);
	    }
	    if(keyValuePair[0] == 'srch'){
	      document.getElementById('releaseName').value = keyValuePair[1];
                      $.ajax({
					type: 'POST',
					url: 'submit',
					data: {releaseName: keyValuePair[1]},
					dataType: 'json',
					success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else { 
                        		document.getElementById("releaseList").innerHTML = "";
                        		appendOptionLast(data);
                        		 }},
					error: function() { alert("Error in data send") }
                      });
	  }

      }
  }
});

function showMenuURL(category){
	var whichcategory = document.getElementById(category);
	if(whichcategory.className == "showM"){
		whichcategory.className="hideM";
	}
	else{
	whichcategory.className="showN";
    }
}

function removeUser(){
  document.getElementById('userNameToBeRemoved').value =""; //clear field so old value wont be shown
      $('#rmUserModal').bind('show', function (){
	  });
      $('#rmUserModal').modal('toggle');  

}

function rmUser(obj){
  var userName = document.getElementById('userNameToBeRemoved').value;
$.ajax({
        type: 'POST',
        url: 'removeUser',
        data: {'user_Name': userName},
        dataType: 'json',
        success: function (data) {if (data.link) {
                                      window.location.href = data.link;
                                 } else {alert(data)}},
        error: function() {alert("Error removing user")}
      });
}

function addUser(){
clearAddUserModal();
  document.getElementById('userNameToBeRemoved').value ="";
      $('#addUserModal').bind('show', function (){
	  });
      $('#addUserModal').modal('toggle');  

}

function showUserForm(obj){
  var userTypeValue = obj.value;
  if(userTypeValue == "Validator"){
    document.getElementById('usrFormList').className = "hideM";
  }
  else{
      document.getElementById('usrFormList').className = "showM";
  }
}

function addUserButtonModal(obj){
  var userName = document.getElementById('newUsrName').value;
  var userTypeValue = document.getElementById('userTypeList').value;
  var userEmail = document.getElementById('newUserEmail').value;
  
  var usrRDataStatsChecked = [""];
  var usrRFastStatsChecked = [""];
  var usrRFullStatsChecked = [""];
  var usrHDataStatsChecked = [""];
  var usrHFastStatsChecked = [""];
  var usrHFullStatsChecked = [""];
  var usrPDataStatsChecked = [""];
  var usrPFastStatsChecked = [""];
  var usrPFullStatsChecked = [""];

  if(userTypeValue == "Validator"){
	//Get Reconstruction category values
      $(document.getElementById('usrRDataStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrRDataStatsChecked.push(catSub);
	}  
      });
        $(document.getElementById('usrRFastStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrRFastStatsChecked.push(catSub);
	}  
      });
      $(document.getElementById('usrRFullStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrRFullStatsChecked.push(catSub);
	}  
      });
   //Get HLT category values
      $(document.getElementById('usrHDataStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrHDataStatsChecked.push(catSub);
	}
      });
      $(document.getElementById('usrHFastStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrHFastStatsChecked.push(catSub);
	}
      });
      $(document.getElementById('usrHFullStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrHFullStatsChecked.push(catSub);
	}
      });
  //Get PAGS category values
      $(document.getElementById('usrPDataStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrPDataStatsChecked.push(catSub);
	}
      });
      $(document.getElementById('usrPFastStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrPFastStatsChecked.push(catSub);
	}
      });
      $(document.getElementById('usrPFullStatList')).children().each(function(){
	var stuff = $(this).children()[0];
	if(stuff.checked == true){
	  var catSub= stuff.getAttribute("id");
	  usrPFullStatsChecked.push(catSub);
	}
      });
  }
$.ajax({
               type: 'POST',
               url: 'addNewUser',
               data: $.param({'user_Name': userName, 'userTypeValue': userTypeValue, 'userEmail': userEmail, 'usrRDataStatList': usrRDataStatsChecked, 'usrRFastStatList': usrRFastStatsChecked, 
                              'usrRFullStatList': usrRFullStatsChecked, 'usrHDataStatList': usrHDataStatsChecked, 'usrHFastStatList': usrHFastStatsChecked, 
                              'usrHFullStatList': usrHFullStatsChecked, 'usrPDataStatList': usrPDataStatsChecked, 'usrPFastStatList': usrPFastStatsChecked, 
                              'usrPFullStatList': usrPFullStatsChecked}, true),
                dataType: 'json',
		success: function (data) {if (data.link) {
                                                  window.location.href = data.link;
                                        } else {alert(data)}},
               error: function() {alert("Error adding user")}
          });
}

function clearAddUserModal(){
  //clear Reco/Data selected list values
    $(document.getElementById('usrRDataStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    //clear Reco/FastSim
    $(document.getElementById('usrRFastStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    //clear Reco/FullSim
    $(document.getElementById('usrRFullStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
  //clear HLT/Data selected list values
    $(document.getElementById('usrHDataStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    //clear HLT/FastSim
    $(document.getElementById('usrHFastStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    //clear HLT/FullSim
    $(document.getElementById('usrHFullStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
  //clear PAGs/Data selected list values
    $(document.getElementById('usrPDataStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    //clear PAGs/FastSim
    $(document.getElementById('usrPFastStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    //clear PAGs/FullSim
    $(document.getElementById('usrPFullStatList')).children().each(function(){
      var stuff = $(this).children()[0];
      stuff.checked = false;
    });
    document.getElementById('userTypeList').value = "------";
    document.getElementById('usrFormList').className = "showM";
    document.getElementById('newUsrName').value = "";
    document.getElementById('newUserEmail').value = "";
}

 function logoutUser(){
    window.location.replace('https://login.cern.ch/adfs/ls/?wa=wsignout1.0');
}
function getUserList(){
  document.getElementById('userNameToSearch').value=""
      $('#srchUserModal').bind('show', function (){
	  });
      $('#srchUserModal').modal('toggle'); 
}
function srchUser(){
  var userName = document.getElementById('userNameToSearch').value;
  window.open('showUsers?' + $.param({'userName': userName}, true));
}
function getAllHistory(){
  window.open('showAllHistory');
}

function showRecoMenu(){
    if (document.getElementById('RECO').className == 'hideM'){
        if (document.getElementById('iRData').className == 'hideM'){
            if (document.getElementById('iRFull').className == 'hideM'){
                if (document.getElementById('iRFast').className == 'hideM'){
                    showMenu('RECO');
                    showMenu('iRData');
                    showMenu('iRFast');
                    showMenu('iRFull');
                    return false;
                }
            }
        }   
    }
    if (document.getElementById('RECO').className == 'showM'){
    showMenu('RECO')
    }
    if (document.getElementById('iRData').className == 'showM'){
    showMenu('iRData')
    }
    if (document.getElementById('iRFull').className == 'showM'){
    showMenu('iRFull')
    }
    if (document.getElementById('iRFast').className == 'showM'){
    showMenu('iRFast')
    }
    return true;
}
function showHLTMenu(){
    if (document.getElementById('HLT').className == 'hideM'){
        if (document.getElementById('iHData').className == 'hideM'){
            if (document.getElementById('iHFull').className == 'hideM'){
                if (document.getElementById('iHFast').className == 'hideM'){
                    showMenu('HLT');
                    showMenu('iHData');
                    showMenu('iHFast');
                    showMenu('iHFull');
                    return false;
                }
            }
        }   
    }
    if (document.getElementById('HLT').className == 'showM'){
    showMenu('HLT')
    }
    if (document.getElementById('iHData').className == 'showM'){
    showMenu('iHData')
    }
    if (document.getElementById('iHFull').className == 'showM'){
    showMenu('iHFull')
    }
    if (document.getElementById('iHFast').className == 'showM'){
    showMenu('iHFast')
    }
    return true;
}
function showPAGSMenu(){
    if (document.getElementById('PAGs').className == 'hideM'){
        if (document.getElementById('iPData').className == 'hideM'){
            if (document.getElementById('iPFull').className == 'hideM'){
                if (document.getElementById('iPFast').className == 'hideM'){
                    showMenu('PAGs');
                    showMenu('iPData');
                    showMenu('iPFast');
                    showMenu('iPFull');
                    return false;
                }
            }
        }   
    }
    if (document.getElementById('PAGs').className == 'showM'){
    showMenu('PAGs')
    }
    if (document.getElementById('iPData').className == 'showM'){
    showMenu('iPData')
    }
    if (document.getElementById('iPFull').className == 'showM'){
    showMenu('iPFull')
    }
    if (document.getElementById('iPFast').className == 'showM'){
    showMenu('iPFast')
    }
    return true;
}
function showAllMenus(){
    if (document.getElementById('RECO').className == 'hideM'){
        if (document.getElementById('iRData').className == 'hideM'){
            if (document.getElementById('iRFull').className == 'hideM'){
                if (document.getElementById('iRFast').className == 'hideM'){
      if (document.getElementById('HLT').className == 'hideM'){
        if (document.getElementById('iHData').className == 'hideM'){
            if (document.getElementById('iHFull').className == 'hideM'){
                if (document.getElementById('iHFast').className == 'hideM'){
      if (document.getElementById('PAGs').className == 'hideM'){
        if (document.getElementById('iPData').className == 'hideM'){
            if (document.getElementById('iPFull').className == 'hideM'){
                if (document.getElementById('iPFast').className == 'hideM'){
                    showMenu('RECO');
                    showMenu('iRData');
                    showMenu('iRFast');
                    showMenu('iRFull');
                                        showMenu('HLT');
                    showMenu('iHData');
                    showMenu('iHFast');
                    showMenu('iHFull');
                                        showMenu('PAGs');
                    showMenu('iPData');
                    showMenu('iPFast');
                    showMenu('iPFull');
                    return false;
                }
              }
           }
        }
                 }
              }
           }
        }
                 }
              }
           }
        }
    if (document.getElementById('RECO').className == 'showM'){
    showMenu('RECO')
    }
    if (document.getElementById('iRData').className == 'showM'){
    showMenu('iRData')
    }
    if (document.getElementById('iRFull').className == 'showM'){
    showMenu('iRFull')
    }
    if (document.getElementById('iRFast').className == 'showM'){
    showMenu('iRFast')
    }
        if (document.getElementById('HLT').className == 'showM'){
    showMenu('HLT')
    }
    if (document.getElementById('iHData').className == 'showM'){
    showMenu('iHData')
    }
    if (document.getElementById('iHFull').className == 'showM'){
    showMenu('iHFull')
    }
    if (document.getElementById('iHFast').className == 'showM'){
    showMenu('iHFast')
    }
        if (document.getElementById('PAGs').className == 'showM'){
    showMenu('PAGs')
    }
    if (document.getElementById('iPData').className == 'showM'){
    showMenu('iPData')
    }
    if (document.getElementById('iPFull').className == 'showM'){
    showMenu('iPFull')
    }
    if (document.getElementById('iPFast').className == 'showM'){
    showMenu('iPFast')
    }
    return true;
}
</script>
</html>

